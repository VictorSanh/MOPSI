#pragma once

#include <cmath>
#include <cassert>
#include <iostream>
#include <ctime>
#include <cstdlib>
#include <Imagine/Graphics.h>
#include <Imagine/Images.h>
#include <math.h>
#include <random>
#include <queue>
#include <stack>
#include <fstream>

//#include "estimateurs.h"
#include "cellules.h"

using namespace std;

void InitRandom();
double Random(double a, double b);

double gaussienne(double mu, double sigma); //Génération d'une gaussienne de paramètres mu et sigma
void verifie_gaussienne(); //Fonction de vérification d'une gaussienne
void afficher(const stack<double>& pile);
double chi2(double x, float n); //renvoie l'évaluation en x de la densité du loi du chi2 à n degrés libertés.

double comparaison_erreur(double tab2[512]);

//Fonction d'écriture dans un fichier extérieur. 
void ecrire(string filename, double data[100]);

// liste des taux de croissance experimentaux
const double tab[512] = { 0.0274,0.0274,0.0307,0.0312,0.0338,0.0337,0.0332,0.0333,0.0359,0.0355,0.0353,0.0343,0.0353,0.0348,0.0351,0.0343,0.0368,0.0361,0.0366,0.0354,0.0369,
0.0356,0.0359,0.0353,0.0369,0.0361,0.0368,0.0354,0.0361,0.0357,0.036,0.0348,0.0377,0.0368,0.0374,0.0362,0.0367,0.0365,0.0367,0.0357,0.0374,0.0364,
0.0372,0.0361,0.0368,0.036,0.0371,0.0354,0.0372,0.0369,0.0373,0.0356,0.0376,0.0369,0.0368,0.0355,0.0372,0.0361,0.0374,0.0364,0.0369,0.0368,0.0367,
0.035,0.0386,0.0377,0.0379,0.0372,0.0379,0.0374,0.0375,0.0363,0.0379,0.0371,0.038,0.0368,0.0375,0.0367,0.0368,0.0351,0.0375,0.0375,0.038,0.0367,0.0374,
0.0366,0.0368,0.0363,0.038,0.0371,0.0374,0.0369,0.0366,0.0369,0.0366,0.0351,0.038,0.0376,0.0379,0.0371,0.038,0.0376,0.0372,0.0361,0.0384,0.0372,0.0385,
0.0371,0.0373,0.0371,0.0372,0.0358,0.0382,0.0374,0.0373,0.0366,0.0376,0.0371,0.0376,0.0364,0.0377,0.0369,0.0378,0.0366,0.0366,0.0365,0.0366,0.0343,
0.0388,0.0375,0.0381,0.0374,0.0382,0.0374,0.0375,0.0364,0.0383,0.0368,0.038,0.0378,0.0378,0.037,0.0371,0.0359,0.0382,0.0381,0.0383,0.0365,0.0382,
0.0375,0.0376,0.0365,0.0382,0.0367,0.0381,0.0367,0.0371,0.0371,0.0369,0.0354,0.0388,0.0379,0.0385,0.0368,0.0383,0.0375,0.0373,0.0365,0.038,0.0373,
0.0382,0.0367,0.0375,0.037,0.0371,0.0362,0.0378,0.0371,0.0374,0.0364,0.038,0.0374,0.037,0.0364,0.0371,0.0369,0.0377,0.0364,0.0365,0.0366,0.0361,
0.0354,0.0381,0.0372,0.038,0.0375,0.0385,0.0385,0.0376,0.037,0.0384,0.0376,0.0382,0.0368,0.0376,0.0373,0.0371,0.0359,0.0383,0.038,0.0383,0.0372,
0.0378,0.0376,0.038,0.0363,0.038,0.0376,0.0381,0.0372,0.0375,0.037,0.0372,0.0357,0.0384,0.0376,0.0382,0.0373,0.0378,0.0366,0.0375,0.0363,0.0381,
0.0383,0.0385,0.037,0.0383,0.0371,0.0372,0.0366,0.0381,0.0368,0.038,0.0366,0.0376,0.0375,0.0374,0.0363,0.0378,0.0371,0.0375,0.0368,0.0374,0.0369,
0.0369,0.0347,0.0373,0.0368,0.0376,0.0364,0.0388,0.0371,0.0386,0.0364,0.0384,0.038,0.0372,0.0385,0.0377,0.0388,0.0376,0.0375,0.0386,0.0369,0.0384,
0.0364,0.037,0.0381,0.0379,0.0386,0.0372,0.0364,0.0378,0.0365,0.0375,0.035,0.0374,0.0366,0.0377,0.0369,0.0371,0.0361,0.0383,0.0378,0.0359,0.0346,
0.0383,0.0388,0.0389,0.0385,0.0387,0.0379,0.0374,0.0371,0.0374,0.0389,0.0363,0.0352,0.0371,0.0377,0.039,0.0365,0.0367,0.036,0.0379,0.0356,0.0353,
0.0372,0.0365,0.0337,0.0398,0.0377,0.0385,0.0378,0.0382,0.0378,0.038,0.0377,0.0384,0.0373,0.0382,0.0366,0.0377,0.0374,0.038,0.0364,0.0381,0.037,
0.0383,0.0356,0.0383,0.038,0.0389,0.0377,0.038,0.0369,0.0379,0.0356,0.0375,0.0362,0.0356,0.0368,0.0394,0.0369,0.0386,0.0375,0.038,0.035,0.0364,
0.0361,0.0397,0.0373,0.0382,0.0366,0.038,0.0362,0.0356,0.0357,0.0385,0.0372,0.0379,0.0371,0.0382,0.0377,0.0371,0.0361,0.0383,0.0364,0.0371,0.0356,
0.0363,0.036,0.036,0.0365,0.0391,0.0378,0.0389,0.0356,0.037,0.0377,0.0365,0.0362,0.0396,0.0373,0.0379,0.0373,0.0358,0.0365,0.0373,0.037,0.0378,
0.0388,0.0377,0.0367,0.0382,0.0385,0.0378,0.0363,0.0386,0.0356,0.0376,0.0358,0.0374,0.037,0.0361,0.035,0.0396,0.0384,0.0381,0.0378,0.0375,0.038,
0.0382,0.0367,0.0387,0.0376,0.0386,0.0381,0.0379,0.0369,0.0373,0.0353,0.0383,0.0366,0.0361,0.0354,0.037,0.0381,0.037,0.0375,0.0383,0.0366,0.0389,
0.0368,0.0377,0.0375,0.0372,0.0347,0.0392,0.037,0.0389,0.0363,0.0394,0.0395,0.0392,0.0382,0.0382,0.0372,0.0396,0.0385,0.0374,0.0366,0.0362,0.0358,
0.0393,0.0378,0.0375,0.0369,0.0388,0.0375,0.0374,0.0373,0.039,0.0355,0.0383,0.0381,0.0382,0.0357,0.0361,0.0339,0.0381,0.0371,0.0379,0.0368,0.0381,
0.038,0.0379,0.0357,0.0391,0.0378,0.0376,0.0365,0.0354,0.0377,0.0367,0.0371,0.0365,0.0376,0.037,0.0356,0.0366,0.0359,0.0382,0.0364,0.0367,
0.0358,0.0377,0.0359,0.0355,0.0374,0.0358,0.0366 };
